# Data configuration for the listening test

## Preliminaries 

Download and unzip [this file](https://drive.google.com/file/d/1p5onef1h9GMZYF8QCriCt4Tkjp8USv0R/view?usp=share_link) that contains a `data_normalized` folder with the following structure:
```
├── C0
│   ├── 1 (116 files)
│   ├── 2 (87 files)
│   └── 3 (29 files)
├── C1
│   ├── 1 (116 files)
│   ├── 2 (87 files)
│   └── 3 (29 files)
├── C2
│   ├── 1 (116 files)
│   ├── 2 (87 files)
│   └── 3 (29 files)
├── C3
│   ├── 1 (116 files)
│   ├── 2 (87 files)
│   └── 3 (29 files)
└── C4
│   ├── 1 (116 files)
│   ├── 2 (87 files)
│   └── 3 (29 files)
└── ref (48 files)
```

**If you downloaded this file before May 5, please redownload it**.

Each directory `Cx` corresponds to an experimental condition (`C0` corresponds to the unprocessed condition and `C1` to `C4` correspond to the submitted systems). Each experimental condition contains a list of stimuli (with the same `wav` file names) organized into three subfolders (`Cx/1`, `Cx/2`, `Cx/3`) corresponding to the maximum number of simultaneously-active speakers in the stimuli (cf. description of the CHiME-5 data for the UDASE task). The directory `ref` contains the reference conditions for the anchoring/training phase of the listening test. See Table 1 of [this paper](https://arxiv.org/pdf/2010.13200.pdf) for a description of the reference conditions.

_Remarks_: 

- All the audio files in the `data_normalized` folder were normalized at -30 LUFS.
- This `data_normalized` folder simulates the data structure for the final listening test. Currently each condition contains exactly the same audio files, it will not be the case in the end. We might actually put all the wav files for a given condition in the same folder, instead of separating them in subfolders `1`, `2`, `3`, but this will not impact how the configuration files are organized.
- This folder can be created from the CHiME-5 data of the UDASE task using the scripts `simulate_data.py`, `LUFS_normalization.py`, and `split_utt_ref_conditions.py`.

## Configuration files

The configuration of the listening test follows the protocol described in [this Google doc](https://docs.google.com/document/d/1mIRKcIShbw0jMrEd8qqZ5ocXI77wIk8jxgVrCD6P6gk/edit?usp=sharing). For an overall visualization of what should be the output of the listening test, you can also have a look at [this Google spreadsheet](https://docs.google.com/spreadsheets/d/1juJbTaKh-vQbdEh0b_XAWzPmUfX3iVNn-_1vZmJOmz4/edit?usp=sharing), where the green cells are the ones that should be filled by the results of the listening experiments.


The folder `config_files` contains the configuration files for each participant to the listening test (subject), in csv or json formats (in the corresponding subfolders). These files were generated by the script `generate_config_files.py`. To understand how it works, you can open any of these configuration files. Each row in a csv file or each entry of a json file corresponds to an audio sample that should be played in a dedicated page of the software interface, and with a dedicated instruction. The randomization has already been done, a configuration file should thus be read linearly by the software.

Each sample is characterized by the following pieces of information:
- `subset` (an integer between 1 and 4): a subset index, as the entire P.835 test is splitted into 4 subsets (or "sub-tests").
- `session` (an integer between 0 and 4): a listening session index. Session index 0 corresponds to the anchoring phase of the test (using the reference conditions). Session indices 1 to 5 correspond to the four listening sessions (using the experimental conditions). Participants should take a short rest period between each session. A dedicated page in the software could tell the participants to have a break.
- `file` (a string): path to the wav file.
- `scale` (a string which is `SIG`, `BAK` or `OVRL`): the rating scale for this sample, which also indicates which instruction to display.

